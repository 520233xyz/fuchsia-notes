\section{gpu driver}
\begin{verbatim}
libmsd_arm.so

out/arm64/obj/build/images/system_image.manifest:driver/libmsd_arm.so=arm64-shared/libmsd_arm.so

out/arm64/arm64-shared/obj/garnet/drivers/gpu/msd-arm-mali/msd_arm.ninja:build arm64-shared/libmsd_arm.so arm64-shared/lib.unstripped/libmsd_arm.so: arm64-shared_solink_module arm64-shared/obj/garnet/lib/magma/src/sys_driver/msd_arm_entry.pdev_entry.o arm64-shared/obj/garnet/drivers/gpu/msd-arm-mali/src/src.address_manager.o arm64-shared/obj/garnet/drivers/gpu/msd-arm-mali/src/src.address_space.o arm64-shared/obj/garnet/drivers/gpu/msd-arm-mali/src/src.entry_stubs.o arm64-shared/obj/garnet/drivers/gpu/msd-arm-mali/src/src.gpu_mapping.o arm64-shared/obj/garnet/drivers/gpu/msd-arm-mali/src/src.job_scheduler.o arm64-shared/obj/garnet/drivers/gpu/msd-arm-mali/src/src.msd_arm_atom.o arm64-shared/obj/garnet/drivers/gpu/msd-arm-mali/src/src.msd_arm_buffer.o arm64-shared/obj/garnet/drivers/gpu/msd-arm-mali/src/src.msd_arm_connection.o arm64-shared/obj/garnet/drivers/gpu/msd-arm-mali/src/src.msd_arm_device.o arm64-shared/obj/garnet/drivers/gpu/msd-arm-mali/src/src.msd_arm_driver.o arm64-shared/obj/garnet/drivers/gpu/msd-arm-mali/src/src.msd_arm_semaphore.o arm64-shared/obj/garnet/drivers/gpu/msd-arm-mali/src/src.power_manager.o arm64-shared/obj/garnet/lib/magma/src/sys_driver/entry.magma_entry.o arm64-shared/obj/garnet/lib/magma/src/magma_util/system.retry_allocator.o arm64-shared/obj/garnet/lib/magma/src/magma_util/system.simple_allocator.o arm64-shared/obj/garnet/lib/magma/src/magma_util/command_buffer.command_buffer.o arm64-shared/obj/garnet/lib/magma/src/magma_util/platform/zircon/handle.zircon_platform_handle.o arm64-shared/obj/zircon/system/ulib/zx/zx.channel.o arm64-shared/obj/zircon/system/ulib/zx/zx.event.o arm64-shared/obj/zircon/system/ulib/zx/zx.eventpair.o arm64-shared/obj/zircon/system/ulib/zx/zx.fifo.o arm64-shared/obj/zircon/system/ulib/zx/zx.guest.o arm64-shared/obj/zircon/system/ulib/zx/zx.interrupt.o arm64-shared/obj/zircon/system/ulib/zx/zx.job.o arm64-shared/obj/zircon/system/ulib/zx/zx.log.o arm64-shared/obj/zircon/system/ulib/zx/zx.port.o arm64-shared/obj/zircon/system/ulib/zx/zx.process.o arm64-shared/obj/zircon/system/ulib/zx/zx.resource.o arm64-shared/obj/zircon/system/ulib/zx/zx.socket.o arm64-shared/obj/zircon/system/ulib/zx/zx.thread.o arm64-shared/obj/zircon/system/ulib/zx/zx.timer.o arm64-shared/obj/zircon/system/ulib/zx/zx.vmar.o arm64-shared/obj/zircon/system/ulib/zx/zx.vmo.o arm64-shared/obj/garnet/lib/magma/src/magma_util/platform/zircon/buffer.zircon_platform_buffer.o arm64-shared/obj/garnet/lib/magma/src/magma_util/platform/zircon/buffer.zircon_platform_bus_mapper.o arm64-shared/obj/garnet/lib/magma/src/magma_util/platform/zircon/trace.zircon_platform_trace.o arm64-shared/obj/zircon/system/ulib/async/async-cpp.receiver.o arm64-shared/obj/zircon/system/ulib/async/async-cpp.task.o arm64-shared/obj/zircon/system/ulib/async/async-cpp.trap.o arm64-shared/obj/zircon/system/ulib/async/async-cpp.wait.o arm64-shared/obj/zircon/system/ulib/async/async.ops.o arm64-shared/obj/zircon/system/ulib/fbl/fbl.alloc_checker.o arm64-shared/obj/zircon/system/ulib/fbl/fbl.memory_probe.o arm64-shared/obj/zircon/system/ulib/fbl/fbl.string.o arm64-shared/obj/zircon/system/ulib/fbl/fbl.string_buffer.o arm64-shared/obj/zircon/system/ulib/fbl/fbl.string_piece.o arm64-shared/obj/zircon/system/ulib/fbl/fbl.string_printf.o arm64-shared/obj/zircon/system/ulib/fbl/fbl.vmar_manager.o arm64-shared/obj/zircon/system/ulib/fbl/fbl.vmo_mapper.o arm64-shared/obj/zircon/system/ulib/async-loop/async-loop-cpp.loop_wrapper.o arm64-shared/obj/zircon/system/ulib/async-loop/async-loop.loop.o arm64-shared/obj/zircon/system/ulib/trace/trace.event.o arm64-shared/obj/zircon/system/ulib/trace/trace.handler.o arm64-shared/obj/zircon/system/ulib/trace/trace.observer.o arm64-shared/obj/zircon/system/ulib/trace-provider/trace-provider.handler_impl.o arm64-shared/obj/zircon/system/ulib/trace-provider/trace-provider.provider_impl.o arm64-shared/obj/zircon/system/ulib/trace-provider/trace-provider.trace_provider.fidl.o arm64-shared/obj/zircon/system/ulib/fidl/fidl.builder.o arm64-shared/obj/zircon/system/ulib/fidl/fidl.decoding.o arm64-shared/obj/zircon/system/ulib/fidl/fidl.encoding.o arm64-shared/obj/zircon/system/ulib/fidl/fidl.formatting.o arm64-shared/obj/zircon/system/ulib/fidl/fidl.message.o arm64-shared/obj/zircon/system/ulib/fidl/fidl.message_buffer.o arm64-shared/obj/zircon/system/ulib/fidl/fidl.message_builder.o arm64-shared/obj/zircon/system/ulib/fidl/fidl.validating.o arm64-shared/obj/garnet/lib/magma/src/magma_util/platform/zircon/object.zircon_platform_object.o arm64-shared/obj/garnet/lib/magma/src/sys_driver/sys_driver.magma_system_buffer.o arm64-shared/obj/garnet/lib/magma/src/sys_driver/sys_driver.magma_system_connection.o arm64-shared/obj/garnet/lib/magma/src/sys_driver/sys_driver.magma_system_context.o arm64-shared/obj/garnet/lib/magma/src/sys_driver/sys_driver.magma_system_device.o arm64-shared/obj/garnet/lib/magma/src/sys_driver/sys_driver.magma_system_semaphore.o arm64-shared/obj/garnet/lib/magma/src/magma_util/platform/zircon/event.zircon_platform_event.o arm64-shared/obj/garnet/lib/magma/src/magma_util/platform/zircon/semaphore.zircon_platform_semaphore.o arm64-shared/obj/garnet/lib/magma/src/magma_util/platform/zircon/thread.zircon_platform_thread.o arm64-shared/obj/garnet/lib/magma/src/magma_util/platform/zircon/connection.zircon_platform_connection.o arm64-shared/obj/garnet/lib/magma/src/magma_util/platform/zircon/device.zircon_platform_device.o arm64-shared/obj/garnet/lib/magma/src/magma_util/platform/zircon/device.zircon_platform_pci_device.o arm64-shared/obj/garnet/lib/magma/src/magma_util/platform/zircon/mmio.zircon_platform_mmio.o arm64-shared/obj/garnet/lib/magma/src/magma_util/registers.register_io.o arm64-shared/obj/garnet/lib/magma/src/magma_util/platform/zircon/port.zircon_platform_port.o arm64-shared/libfsl.so arm64-shared/libfxl.so arm64-shared/libfxl_logging.so | arm64-shared/obj/zircon/public/lib/ddk/libddk.a arm64-shared/obj/zircon/public/lib/pretty/libpretty.a arm64-shared/lib.unstripped/libfdio.so arm64-shared/obj/zircon/public/lib/sync/libsync.a arm64-shared/lib.unstripped/libasync-default.so arm64-shared/lib.unstripped/libdriver.so arm64-shared/lib.unstripped/libtrace-engine.so arm64-shared/lib.unstripped/libsyslog.so || arm64-shared/obj/garnet/drivers/gpu/msd-arm-mali/msd_arm_entry.stamp arm64-shared/obj/garnet/drivers/gpu/msd-arm-mali/src/src.stamp arm64-shared/obj/garnet/lib/magma/src/sys_driver/entry.stamp arm64-shared/obj/garnet/lib/magma/src/magma_util/common.stamp arm64-shared/obj/garnet/lib/magma/src/magma_util/system.stamp arm64-shared/obj/garnet/lib/magma/include/magma_abi_common.stamp arm64-shared/obj/garnet/lib/magma/src/magma_util/command_buffer.stamp arm64-shared/obj/garnet/lib/magma/include/msd_abi.stamp arm64-shared/obj/garnet/lib/magma/src/magma_util/platform/buffer.stamp arm64-shared/obj/garnet/lib/magma/src/magma_util/platform/handle.stamp arm64-shared/obj/garnet/lib/magma/src/magma_util/platform/zircon/handle.stamp arm64-shared/obj/zircon/public/lib/zx/zx.stamp arm64-shared/obj/garnet/lib/magma/src/magma_util/platform/zircon/buffer.stamp arm64-shared/obj/garnet/lib/magma/src/magma_util/platform/trace.stamp arm64-shared/obj/garnet/lib/magma/src/magma_util/platform/zircon/trace.stamp arm64-shared/obj/zircon/public/lib/async-cpp/async-cpp.stamp arm64-shared/obj/zircon/public/lib/async/async.stamp arm64-shared/obj/zircon/public/lib/fbl/fbl.stamp arm64-shared/obj/zircon/public/lib/async-loop-cpp/async-loop-cpp.stamp arm64-shared/obj/zircon/public/lib/async-loop/async-loop.stamp arm64-shared/obj/zircon/public/lib/trace/trace.stamp arm64-shared/obj/zircon/public/lib/trace-provider/trace-provider.stamp arm64-shared/obj/zircon/public/lib/fidl/fidl.stamp arm64-shared/obj/garnet/lib/magma/src/magma_util/platform/object.stamp arm64-shared/obj/garnet/lib/magma/src/magma_util/platform/zircon/object.stamp arm64-shared/obj/garnet/lib/magma/src/sys_driver/sys_driver.stamp arm64-shared/obj/garnet/lib/magma/include/magma_abi.stamp arm64-shared/obj/garnet/lib/magma/src/magma_util/platform/connection.stamp arm64-shared/obj/garnet/lib/magma/src/magma_util/platform/event.stamp arm64-shared/obj/garnet/lib/magma/src/magma_util/platform/zircon/event.stamp arm64-shared/obj/garnet/lib/magma/src/magma_util/platform/semaphore.stamp arm64-shared/obj/garnet/lib/magma/src/magma_util/platform/zircon/semaphore.stamp arm64-shared/obj/garnet/lib/magma/src/magma_util/platform/thread.stamp arm64-shared/obj/garnet/lib/magma/src/magma_util/platform/zircon/thread.stamp arm64-shared/obj/garnet/lib/magma/src/magma_util/platform/zircon/connection.stamp arm64-shared/obj/garnet/lib/magma/src/magma_util/platform/device.stamp arm64-shared/obj/garnet/lib/magma/src/magma_util/platform/zircon/device.stamp arm64-shared/obj/garnet/lib/magma/src/magma_util/platform/zircon/interrupt.stamp arm64-shared/obj/garnet/lib/magma/src/magma_util/platform/zircon/mmio.stamp arm64-shared/obj/garnet/lib/magma/src/magma_util/platform/mmio.stamp arm64-shared/obj/garnet/drivers/gpu/msd-arm-mali/include/include.stamp arm64-shared/obj/garnet/lib/magma/src/magma_util/registers.stamp arm64-shared/obj/garnet/lib/magma/src/magma_util/thread.stamp arm64-shared/obj/garnet/lib/magma/src/magma_util/platform/port.stamp arm64-shared/obj/garnet/lib/magma/src/magma_util/platform/zircon/port.stamp

ZX_PROTOCOL_INTEL_GPU_CORE的定义在//zircon/system/ulib/ddk/include/ddk/driver.h

intel gpu 驱动加载

//zircon/system/dev/display/intel-i915/intel-i915.cpp

device_add_args_t args = {};
args.version = DEVICE_ADD_ARGS_VERSION;
args.name = "intel-gpu-core";
args.ctx = this;
args.ops = &i915_gpu_core_device_proto;
args.proto_id = ZX_PROTOCOL_INTEL_GPU_CORE;
args.proto_ops = &i915_gpu_core_protocol_ops;

device_add(zxdev(), &args, &zx_gpu_dev_)






每次来一个Controller::DdkOpenAt()就会创建一个ClientProxy对应之。

\end{verbatim}